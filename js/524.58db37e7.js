"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[524],{27673:function(e,t,n){n.a(e,(async function(e){n(85827);var a=n(66252),r=n(2262),o=n(30370),u=n(92479),l=n(86690),i=n(36079),d=n(62478),c=n(30119),s=n(83927),f=n(14323),h=e([o,i,l,u,d]);[o,i,l,u,d]=h.then?await h:h;const p=(0,a.Uk)(" 新增 ");t.Z=(0,a.aZ)({name:"SystemPermissionRole",setup(e){const t=(0,r.iH)(),[n]=(0,d.U)(),h=(e,t,n=[])=>t.reduce(((t,a)=>{var r;return null!==(r=a.children)&&void 0!==r&&r.length?h(e,a.children,n):e.includes(a.value)&&t.push(a.value),t}),n),m=async e=>{var a;const[r]=await n({modalProps:{title:(e.id?"编辑":"新增")+"角色",width:"50%",onFinish:async n=>{var a,u,l,i,d;e.id&&(n.roleId=e.id);const c=null===(a=r.value)||void 0===a||null===(u=a.compRefs)||void 0===u?void 0:u.menus,s=null===(l=r.value)||void 0===l||null===(i=l.compRefs)||void 0===i?void 0:i.depts,f={...n,menus:[...c.halfCheckedKeys,...c.checkedKeys],depts:[...s.halfCheckedKeys,...s.checkedKeys]};await(e.id?o.ul:o.fA)(f),null===(d=t.value)||void 0===d||d.refreshTable()}},formSchema:{labelWidth:100,layout:"vertical",schemas:s.y}}),[i,d]=await Promise.all([(0,u.U4)(),(0,l.Af)()]),c=(0,f.bl)(d),p=(0,f.fl)(i);if(null===(a=r.value)||void 0===a||a.updateSchema([{field:"menus",componentProps:{treeData:c}},{field:"depts",componentProps:{treeData:p}}]),e.id){var m;const t=await(0,o.Xt)({roleId:e.id}),n=t.menus.map((e=>e.menuId)),a=t.depts.map((e=>e.departmentId));null===(m=r.value)||void 0===m||m.setFieldsValue({...e,name:t.roleInfo.name,label:t.roleInfo.label,remark:t.roleInfo.remark,menus:h(n,c),depts:h(a,p)})}},v=[...c.f,{title:"操作",width:160,dataIndex:"$action",hideInSearch:!0,align:"center",fixed:"right",actions:({record:e})=>[{label:"编辑",auth:{perm:"sys.role.update",effect:"disable"},onClick:()=>m(e)},{label:"删除",auth:"sys.role.delete",popConfirm:{title:"你确定要删除吗？",onConfirm:()=>(async e=>{var n;await(0,o.Rd)({roleIds:[e.id]}),null===(n=t.value)||void 0===n||n.refreshTable()})(e)}}]}];return(e,n)=>{const u=(0,a.up)("a-button");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)((0,r.SU)(i.t),{ref_key:"dynamicTableRef",ref:t,"row-key":"id","header-title":"角色管理","data-request":(0,r.SU)(o.$s),columns:v,bordered:"",size:"small"},{toolbar:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"primary",disabled:!e.$auth("sys.role.add"),onClick:n[0]||(n[0]=e=>m({}))},{default:(0,a.w5)((()=>[p])),_:1},8,["disabled"])])),_:1},8,["data-request"])])}}})}))},92479:function(e,t,n){n.a(e,(async function(e){n.d(t,{U4:function(){return u},aS:function(){return l},MB:function(){return i},UJ:function(){return d},m3:function(){return c}});var a=n(22586),r=n(65900),o=e([a]);function u(){return(0,a.W)({url:r.default.list,method:"get"})}function l(e){return(0,a.W)({url:"sys/dept/delete",method:"post",data:e},{successMsg:"删除成功"})}function i(e){return(0,a.W)({url:r.default.update,method:"post",data:e})}function d(e){return(0,a.W)({url:r.default.add,method:"post",data:e})}function c(e){return(0,a.W)({url:r.default.transfer,method:"post",data:e})}a=(o.then?await o:o)[0]}))},86690:function(e,t,n){n.a(e,(async function(e){n.d(t,{Af:function(){return u},ZT:function(){return l},_8:function(){return i},RD:function(){return d}});var a=n(22586),r=n(43536),o=e([a]);function u(){return(0,a.W)({url:r.default.list,method:"get"})}function l(e){return(0,a.W)({url:r.default.add,method:"post",data:e},{successMsg:"创建成功"})}function i(e){return(0,a.W)({url:r.default.update,method:"post",data:e},{successMsg:"更新成功"})}function d(e){return(0,a.W)({url:r.default.delete,method:"post",data:e},{successMsg:"删除成功"})}a=(o.then?await o:o)[0]}))},30370:function(e,t,n){n.a(e,(async function(e){n.d(t,{Xt:function(){return u},JV:function(){return l},$s:function(){return i},fA:function(){return d},ul:function(){return c},Rd:function(){return s}});var a=n(22586),r=n(25620),o=e([a]);function u(e){return(0,a.W)({url:r.default.info,method:"get",params:e})}function l(e){return(0,a.W)({url:r.default.list,method:"get",data:e})}function i(e){return(0,a.W)({url:r.default.page,method:"get",params:e})}function d(e){return(0,a.W)({url:r.default.add,method:"post",data:e},{successMsg:"创建角色成功"})}function c(e){return(0,a.W)({url:r.default.update,method:"post",data:e},{successMsg:"更新角色成功"})}function s(e){return(0,a.W)({url:r.default.delete,method:"post",data:e},{successMsg:"删除角色成功"})}a=(o.then?await o:o)[0]}))},14323:function(e,t,n){n.d(t,{fl:function(){return a},bl:function(){return r},BQ:function(){return o}});n(85827);const a=(e,t=null,n=[])=>e.filter((e=>e.parentId===t)).map((r=>{const o=n.concat(t||[]),u=a(e,r.id,o);return Object.assign(r,{keyPath:o,title:r.name,key:r.id,value:r.id,formData:r,children:u.length?u:null})})),r=(e,t=null,n=[])=>e.filter((e=>e.parentId===t)).map((a=>{const o=n.concat(t||[]),u=r(e,a.id,o);return Object.assign(a,{keyPath:o,title:a.name,key:a.id,value:a.id,formData:a,children:u.length?u:null})})),o=(e,t=[],n="id",a="children")=>t.reduce(((t,r)=>{var u;return r[n]===e?r:t||(null!==(u=r[a])&&void 0!==u&&u.length?o(e,r[a],n,a):void 0)}),void 0)},13959:function(e,t,n){n.d(t,{n:function(){return o}});var a=n(66252),r=n(2262);function o(e,t){return{initSortable:function(){(0,a.Y3)((async()=>{if(!e)return;(await n.e(474).then(n.bind(n,51474))).default.create((0,r.SU)(e),{animation:500,delay:400,delayOnTouchOnly:!0,...t})}))}}}},83927:function(e,t,n){n.d(t,{y:function(){return a}});const a=[{field:"name",component:"Input",label:"名称",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"label",component:"Input",label:"标识",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"remark",component:"InputTextArea",label:"备注"},{field:"menus",component:"Tree",label:"菜单权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"350px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}},{field:"depts",component:"Tree",label:"部门权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"350px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}}]},30119:function(e,t,n){n.d(t,{f:function(){return a}});const a=[{title:"#",dataIndex:"id",width:55,align:"center",hideInSearch:!0},{title:"名称",width:200,align:"center",dataIndex:"name"},{title:"标识",width:80,align:"center",dataIndex:"label"},{title:"备注",dataIndex:"remark",align:"center"},{title:"创建时间",dataIndex:"createdAt",align:"center",hideInSearch:!0},{title:"更新时间",align:"center",dataIndex:"updatedAt",hideInSearch:!0}]},12316:function(e,t,n){n.d(t,{C:function(){return i}});n(48675),n(3462);var a=n(93162),r=n(84105);function o(e,t){for(var n,a={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},u=0;u!=e.length;++u)for(var l=0;l!=e[u].length;++l){o.s.r>u&&(o.s.r=u),o.s.c>l&&(o.s.c=l),o.e.r<u&&(o.e.r=u),o.e.c<l&&(o.e.c=l);var i={v:e[u][l]};if(null!=i.v){var d=r.P6.encode_cell({c:l,r:u});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=r.kS._table[14],i.v=(n=i.v,void 0&&(n+=1462),(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5)):i.t="s",a[d]=i}}return o.s.c<1e7&&(a["!ref"]=r.P6.encode_range(o)),a}function u(){if(!(this instanceof u))return new u;this.SheetNames=[],this.Sheets={}}function l(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=255&e.charCodeAt(a);return t}function i({multiHeader:e=[],header:t,data:n,filename:i,merges:d=[],autoWidth:c=!0,bookType:s="xlsx"}={}){i=i||"excel-list",(n=[...n]).unshift(t);for(let t=e.length-1;t>-1;t--)n.unshift(e[t]);var f="SheetJS",h=new u,p=o(n);if(d.length>0&&(p["!merges"]||(p["!merges"]=[]),d.forEach((e=>{p["!merges"].push(r.P6.decode_range(e))}))),c){const e=n.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}))));let t=e[0];for(let n=1;n<e.length;n++)for(let a=0;a<e[n].length;a++)t[a].wch<e[n][a].wch&&(t[a].wch=e[n][a].wch);p["!cols"]=t}h.SheetNames.push(f),h.Sheets.SheetJS=p;var m=(0,r.cW)(h,{bookType:s,bookSST:!1,type:"binary"});(0,a.saveAs)(new Blob([l(m)],{type:"application/octet-stream"}),`${i}.${s}`)}},19258:function(e,t,n){n.a(e,(async function(e){n.r(t);var a=n(11013),r=e([a]);const o=(a=(r.then?await r:r)[0]).Z;t.default=o}))},11013:function(e,t,n){n.a(e,(async function(e){n.d(t,{Z:function(){return a.Z}});var a=n(27673),r=e([a]);a=(r.then?await r:r)[0]}))}}]);